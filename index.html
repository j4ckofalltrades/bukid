<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>PH Mountains</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no"/>
    <script src="https://unpkg.com/maplibre-gl@2.1.9/dist/maplibre-gl.js"></script>
    <link href="https://unpkg.com/maplibre-gl@2.1.9/dist/maplibre-gl.css" rel="stylesheet"/>
    <style>
        body {
            margin: 0;
            padding: 0;
        }

        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }
    </style>
</head>
<body>
<div id="map"></div>
<script>
  var map = new maplibregl.Map({
    container: 'map',
    style: 'https://api.maptiler.com/maps/topo/style.json?key=get_your_own_OpIi9ZULNHzrESv6T2vL',
    center: [121.652, 12.954],
    zoom: 6
  });

  map.on('load', function () {
    map.addSource('mountains', {
      'type': 'geojson',
      'data': './data/geojson/index.geojson'
    });

    map.addLayer({
      'id': 'mountains',
      'type': 'symbol',
      'source': 'mountains',
      'layout': {
        'icon-image': ['image', 'mountain_15'],
        'icon-overlap': 'cooperative',
        'text-field': ['get', 'name'],
        'text-size': 11,
        'text-font': [
          'Open Sans Semibold',
          'Arial Unicode MS Bold'
        ],
        'text-offset': [0, 1.25],
        'text-anchor': 'top'
      }
    });

    map.addControl(new maplibregl.NavigationControl());
  });

  var popup = new maplibregl.Popup({
    closeButton: false,
    closeOnClick: false
  });

  map.on('mouseenter', 'mountains', function (e) {
    map.getCanvas().style.cursor = 'pointer';

    var coordinates = e.features[0].geometry.coordinates.slice();
    while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
      coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
    }

    var name = e.features[0].properties.name;
    var elevation = e.features[0].properties.elev;
    var prominence = e.features[0].properties.prom;

    popup.setLngLat(coordinates)
        .setHTML(
            "<div>" +
            "<strong>Name: </strong>" + name + "<br/>" +
            "<strong>Elevation: </strong>" + elevation + "<br/>" +
            "<strong>Prominence: </strong>" + prominence + "<br/>" +
            "</div>"
        )
        .addTo(map);
  });

  map.on('mouseleave', 'mountains', function () {
    map.getCanvas().style.cursor = '';
    popup.remove();
  });
</script>

</body>
</html>
